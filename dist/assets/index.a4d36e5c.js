import{z as t,l as e,t as s,a as n,b as i,s as r,c as o,d as a}from"./vendor.89404cbd.js";!function(t=".",e="__import__"){try{self[e]=new Function("u","return import(u)")}catch(s){const n=new URL(t,location),i=t=>{URL.revokeObjectURL(t.src),t.remove()};self[e]=t=>new Promise(((s,r)=>{const o=new URL(t,n);if(self[e].moduleMap[o])return s(self[e].moduleMap[o]);const a=new Blob([`import * as m from '${o}';`,`${e}.moduleMap['${o}']=m;`],{type:"text/javascript"}),l=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(a),onerror(){r(new Error(`Failed to import: ${t}`)),i(l)},onload(){s(self[e].moduleMap[o]),i(l)}});document.head.appendChild(l)})),self[e].moduleMap={}}}("/assets/");const l=document.querySelector("#app");class h{constructor(t){this.stuff=t}get Components(){return new Set(this.stuff.components.keys())}get Context(){return null}get Element(){return this.stuff.element}getComponent(t){var e;return null==(e=this.stuff.components.get(t))?void 0:e.exports}}class u{constructor(){this._stuff=null,this._context=null,this.Stuff=null,this.Context=null,this.props=new Map,this.requirements=[]}beforeAttach(t){this._stuff=t,this.Stuff=new h(this._stuff)}}class c extends u{constructor(){super(...arguments),this.name="render",this.position=t([3]),this.size=t([2]),this.rotate=t([3]),this.rotateUnit="deg",this.exports={setPosition:t=>{e.assert(3==t.shape[0]),this.position=t},getPosition:()=>this.position,setSize:t=>{e.assert(2==t.shape[0]),this.size=t},setRotate:(t,e="deg")=>{this.exports.setAxisRotate(s([0,0,t]),e)},setAxisRotate:(t,e="deg")=>{this.rotate=t,this.rotateUnit=e}}}beforeAttach(t){super.beforeAttach(t)}render(t){if(null!=this._stuff&&this.Stuff){let t=this.Stuff.Element,e=this.position.arraySync(),s=this.size.arraySync(),n=this.rotate.arraySync(),i=this.rotateUnit;t.style.height=`${s[0]}px`,t.style.width=`${s[1]}px`;let r=`translate(${e[0]}px,${e[1]}px) rotateX(${n[0]}${i}) rotateY(${n[1]}${i}) rotateZ(${n[2]}${i})`;t.style.transform=r}}}class f extends u{constructor(){super(...arguments),this.name="mechanics",this.m=1,this.E=t=>n([[1,t,0,0],[0,1,t,0],[0,0,0,1/this.m],[0,0,0,1]]),this.X=t([4,3]),this.addF=t=>{3==t.shape[0]&&(this.X=this.X.add(i([[0,0,0],[0,0,0],[0,0,0],[...t.arraySync()]])))},this.setF=t=>{this.X=this.X.mul(n([[1,1,0]])),this.addF(t)},this.setXState=(t=null,s=null,n=null,i=null)=>{4==[t,s,n,i].filter((t=>null==t||3==t.shape[0])).length?(t=null!=t?t:this.X.slice(0,1).as1D(),s=null!=s?s:this.X.slice(1,1).as1D(),n=null!=n?n:this.X.slice(2,1).as1D(),i=null!=i?i:this.X.slice(3,1).as1D(),this.X=r([t,s,n,i])):e.error("错误,维度错误")},this.getState=t=>{switch(t){case"Pos":return this.X.slice(0,1).as1D();case"V":return this.X.slice(1,1).as1D();case"ACC":return this.X.slice(2,1).as1D();case"F":return this.X.slice(3,1).as1D()}},this.exports={getState:this.getState,setF:this.setF,addF:this.addF,setX:this.setXState}}toNext(t){const e=this.E(t);this.X=e.matMul(this.X)}beforeAttach(t){super.beforeAttach(t)}render(t){if(null==this._stuff)return;if(null==t)return;this.toNext(t/1e3);let e=this.X.slice(0,1).as1D();if(this.Stuff){this.Stuff.getComponent("render").setPosition(e)}}}class p extends class extends class{constructor(t,e){this.element=t,this.components=e,this.context=null}beforeRegister(t){this.context=t;for(let e of this.components.values())e.stuffBeforeRegister&&e.stuffBeforeRegister(t)}render(t){if(null!=this.context)for(let e of this.components.values())e.render(t)}}{constructor(){super(function(){let t=document.createElement("div");return null==l||l.appendChild(t),t}(),new Map),this.Operations=new h(this),this.waitAttatches=[]}isRequirementsOk(t){return!0}addWaitingComponent(t){this.waitAttatches.push(t)}attachComponent(t){this.isRequirementsOk(t)?(t.beforeAttach&&t.beforeAttach(this),this.components.set(t.name,t)):this.addWaitingComponent(t)}}{constructor(){super(),this.attachComponent(new c),this.attachComponent(new d),this.attachComponent(new f),this.Operations.getComponent("mechanics").setX(i([100,100,100]),t([3]),i([0,0,0]),i([0,2e3,0]))}render(t){super.render(t);let e=this.Operations.getComponent("render");if(e.setSize(i([100,100])),this.Operations.getComponent("render"),e.getPosition().arraySync()[1]>500){let t=this.Operations.getComponent("mechanics");t.setX(i([t.getState("Pos").arraySync()[0],500,0]),t.getState("V").mul([0,-.85,0]).as1D(),null,null)}}}o("cpu");const m=new class{constructor(){this.listofStuff=[]}register(t){null!=t.beforeRegister&&t.beforeRegister(this),this.listofStuff.push(t)}};class d extends u{constructor(){super(...arguments),this.exports={},this.name="colorchange"}render(t){if(null==this._stuff)return;let e=`hsla(${360*Math.random()},${100*Math.random()}%,${100*Math.random()}%,${Math.random()})`;this._stuff.element.style.backgroundColor=e}}!async function(){let t=null;function s(){if(null==t)return t=a(),null;{let e=a(new Date),s=e.diff(t);return t=e,s}}for(;;){await e.delay(20);for(let t of m.listofStuff){let e=s();t.render(e)}}}();let g=document.querySelector("button");g&&(g.onclick=function(){m.register(new p)});
